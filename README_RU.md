# Tonal DJ - Анализатор совместимости треков с AI

Десктопное приложение для диджеев, использующее **AI-анализ аудио** для поиска совместимых треков на основе музыкального контента, тональности и BPM.

![Tonal DJ Screenshot](assets/main.png)

## AI Функции

- **Анализ контента** - Использует нейросеть CLAP (Contrastive Language-Audio Pretraining) для анализа аудио и поиска похожих по звучанию треков
- **AI Определение жанра** - Автоматическое определение жанра (Drum & Bass, House, Techno, Dubstep, Trance и др.)
- **AI Определение настроения** - Классификация настроения трека (Energetic, Dark, Melodic, Aggressive, Uplifting и др.)
- **Комбинированная оценка** - Интеллектуальное сочетание гармонической совместимости и схожести контента

## Основные функции

- **Определение BPM** - Автоматическое определение темпа с помощью анализа битов
- **Определение тональности** - Определение музыкальной тональности по алгоритму Крумхансл-Шмуклера
- **Camelot Wheel** - Автоматическое преобразование в нотацию Camelot для гармонического сведения
- **Оценка совместимости** - Расчёт процента совпадения между треками
- **Множитель BPM** - Поддержка половинного (x0.5) и двойного (x2) темпа
- **Метаданные MP3** - Чтение/запись результатов анализа в ID3 теги
- **Локальный кэш** - База данных SQLite для быстрой загрузки
- **Воспроизведение** - Встроенный плеер для прослушивания
- **Мультиязычность** - Русский и английский интерфейс
- **Drag & Drop** - Удобная загрузка файлов
- **Экспорт в CSV** - Экспорт списка треков

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/NuclearAPK/tonaldjanalyzer.git
cd tonaldjanalyzer
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Запустите приложение:
```bash
python main.py
```

## Требования

- Python 3.8+
- PyQt5
- PyTorch
- Transformers (для модели CLAP)
- librosa
- numpy, scipy
- soundfile, pygame
- mutagen

## Использование

1. **Загрузка треков** - Нажмите "Загрузить треки" или перетащите аудиофайлы
2. **Выбор мастер-трека** - Выберите трек и нажмите "Выбрать мастер"
3. **AI Анализ** - Нажмите "AI анализ" для запуска анализа контента
4. **Просмотр совместимости** - Все треки показывают комбинированную совместимость
5. **Сортировка** - Нажмите "Сортировать" для сортировки по совместимости
6. **Настройка BPM** - Правый клик для установки множителя BPM
7. **Экспорт** - Нажмите "Экспорт CSV" для сохранения результатов

## Как работает AI-анализ

Модель CLAP создаёт аудио-эмбеддинги (512-мерные векторы), которые отражают звуковые характеристики каждого трека. При выборе мастер-трека приложение вычисляет косинусное сходство между эмбеддингами для поиска похожих по звучанию треков — независимо от тональности или BPM.

Финальная оценка **Match** объединяет:
- **Гармоническую совместимость** (тональность/Camelot)
- **Схожесть контента** (AI-анализ аудио)

## Поддерживаемые форматы

MP3, WAV, FLAC, OGG, M4A, AAC

## Лицензия

MIT License
