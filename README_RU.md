# Tonal DJ - Анализатор совместимости треков

Десктопное приложение для диджеев, которое анализирует аудиотреки и находит совместимые пары на основе музыкальной тональности (нотация Camelot Wheel) и BPM для плавного сведения.

## Возможности

- **Определение BPM** - Автоматическое определение темпа с помощью анализа битов
- **Определение тональности** - Определение музыкальной тональности по алгоритму Крумхансл-Шмуклера
- **Camelot Wheel** - Автоматическое преобразование в нотацию Camelot для гармонического сведения
- **Оценка совместимости** - Расчёт процента совпадения между треками на основе тональности и BPM
- **Множитель BPM** - Поддержка половинного (x0.5) и двойного (x2) темпа
- **Метаданные MP3** - Чтение/запись результатов анализа в ID3 теги MP3 файлов
- **Локальный кэш** - База данных SQLite для быстрой загрузки ранее проанализированных треков
- **Воспроизведение** - Встроенный плеер для предварительного прослушивания
- **Drag & Drop** - Удобная загрузка файлов перетаскиванием
- **Экспорт в CSV** - Экспорт списка треков с данными о совместимости

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/yourusername/TonalDJPlugin.git
cd TonalDJPlugin
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Запустите приложение:
```bash
python main.py
```

## Требования

- Python 3.8+
- PyQt5
- librosa
- numpy
- scipy
- soundfile
- pygame
- mutagen

## Использование

1. **Загрузка треков** - Нажмите "Load Tracks" или перетащите аудиофайлы (MP3, WAV, FLAC, OGG, M4A)
2. **Выбор мастер-трека** - Выберите трек и нажмите "Set as Master" или используйте контекстное меню
3. **Просмотр совместимости** - Все треки покажут процент совместимости с мастер-треком
4. **Сортировка по Match** - Нажмите "Sort by Match" для сортировки по совместимости (переключение возрастание/убывание)
5. **Настройка BPM** - Правый клик на треке для установки множителя BPM (x0.5, x1, x2)
6. **Воспроизведение** - Двойной клик или контекстное меню для прослушивания
7. **Экспорт** - Нажмите "Export CSV" для сохранения результатов анализа

## Camelot Wheel

Camelot Wheel - инструмент, помогающий диджеям сводить треки гармонично. Совместимые тональности:
- Одинаковая тональность (например, 8A к 8A)
- Соседние номера (например, 8A к 7A или 9A)
- Одинаковый номер, разная буква (например, 8A к 8B - параллельный мажор/минор)

## Поддерживаемые форматы

- MP3
- WAV
- FLAC
- OGG
- M4A
- AAC

## Структура проекта

```
TonalDJPlugin/
├── main.py                 # Точка входа
├── requirements.txt        # Зависимости Python
├── src/
│   ├── audio/
│   │   ├── analyzer.py     # Анализ BPM и тональности
│   │   ├── camelot.py      # Логика Camelot Wheel
│   │   ├── metadata.py     # Работа с ID3 тегами MP3
│   │   └── player.py       # Воспроизведение аудио
│   ├── core/
│   │   ├── cache.py        # SQLite кэш
│   │   ├── compatibility.py # Расчёт совместимости
│   │   └── track.py        # Модель данных трека
│   └── ui/
│       ├── main_window.py  # Главное окно
│       ├── player_widget.py # Виджет плеера
│       ├── styles.py       # Стили и цвета
│       └── track_table.py  # Таблица треков
└── tests/
    └── test_camelot.py     # Тесты
```

## Лицензия

MIT License
